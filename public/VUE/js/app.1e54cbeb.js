(function(){"use strict";var t={1486:function(t,e,o){var a=o(6848),s=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"app-wrapper"},[t._m(0),e("LeftMenu",{on:{"cambiar-componente":t.setAccion}}),e("main",{staticClass:"app-main"},[e("div",{staticClass:"app-content-header"},[e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-6"},[e("h3",{staticClass:"mb-0"},[t._v(t._s(t.titulo))])]),t._m(1)])])]),e("div",{staticClass:"app-content"},[e("div",{staticClass:"container-fluid",attrs:{id:"dContent",name:"dContent"}},[e(t.accion,{tag:"component",attrs:{autor:t.autorActual,post:t.postActual},on:{volver:function(e){return t.setAccion("AutorList")},listPosts:function(e){return t.setAccion("PostList")},"cambiar-componente":t.setAccion}})],1)])]),e("Footer")],1)])},r=[function(){var t=this,e=t._self._c;return e("nav",{staticClass:"app-header navbar navbar-expand bg-body"},[e("div",{staticClass:"container-fluid"},[e("ul",{staticClass:"navbar-nav ms-auto"},[e("li",{staticClass:"nav-item"},[e("a",{staticClass:"btn btn-success",attrs:{href:"/"}},[t._v("Ir a los post en vivo")])])])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-sm-6 d-none"},[e("ol",{staticClass:"breadcrumb float-sm-end"},[e("li",{staticClass:"breadcrumb-item"},[e("a",{attrs:{href:"#"}},[t._v("Home")])]),e("li",{staticClass:"breadcrumb-item active",attrs:{"aria-current":"page"}},[t._v("Dashboard")])])])}],n=function(){var t=this,e=t._self._c;return e("aside",{staticClass:"app-sidebar bg-body-secondary shadow",attrs:{"data-bs-theme":"dark"}},[t._m(0),e("div",{staticClass:"sidebar-wrapper"},[e("nav",{staticClass:"mt-2"},[e("ul",{staticClass:"nav sidebar-menu flex-column",attrs:{"data-lte-toggle":"treeview",role:"menu","data-accordion":"false"}},[e("li",{staticClass:"nav-header"},[t._v("AUTORES")]),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.setAccion("AutorCreate")}}},[e("i",{staticClass:"bi bi-person-fill-add"}),e("p",[t._v("Crear")])])]),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.setAccion("AutorList")}}},[e("i",{staticClass:"bi bi-list-ul"}),e("p",[t._v("Listar")])])]),e("li",{staticClass:"nav-header"},[t._v("POSTS")]),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.setAccion("PostCreate")}}},[e("i",{staticClass:"bi bi-pencil-square"}),e("p",[t._v("Crear")])])]),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.setAccion("PostList")}}},[e("i",{staticClass:"bi bi-list-ul"}),e("p",[t._v("Listar")])])])])])])])},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"sidebar-brand"},[e("a",{staticClass:"brand-link",attrs:{href:"./index.html"}},[e("span",{staticClass:"brand-text fw-light"},[t._v("Gestión de blog")])])])}],l={name:"LeftMenu",data(){return{accion:null}},methods:{setAccion(t){this.accion=t,this.$emit("cambiar-componente",this.accion)}}},c=l,u=o(1656),d=(0,u.A)(c,n,i,!1,null,"940e8c58",null),m=d.exports,p=function(){var t=this;t._self._c;return t._m(0)},h=[function(){var t=this,e=t._self._c;return e("footer",{staticClass:"app-footer"},[e("div",{staticClass:"float-end d-none d-sm-inline"},[t._v("Anything you want")]),e("strong",[t._v(" Copyright © 2014-2024  "),e("a",{staticClass:"text-decoration-none",attrs:{href:"https://adminlte.io"}},[t._v("AdminLTE.io")]),t._v(". ")]),t._v(" All rights reserved. ")])}],b={name:"LeftMenu"},f=b,g=(0,u.A)(f,p,h,!1,null,"e1322d5a",null),v=g.exports,_=function(){var t=this,e=t._self._c;return e("form",[e("div",{staticClass:"mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"nombre"}},[t._v("Nombre")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.nombre,expression:"nombre"}],staticClass:"form-control",attrs:{type:"text",id:"nombre","aria-describedby":"name"},domProps:{value:t.nombre},on:{input:function(e){e.target.composing||(t.nombre=e.target.value)}}})]),e("div",{staticClass:"mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"email"}},[t._v("Email ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control",attrs:{type:"email",id:"email","aria-describedby":"email"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}}),1==t.create_errors.mail?e("div",{staticClass:"form-text",attrs:{id:"emailHelp"}},[t._v("We'll never share your email with anyone else.")]):t._e()]),e("div",{staticClass:"mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"foto"}},[t._v("Seleccione una foto (opcional)")]),e("input",{staticClass:"form-control",attrs:{type:"file",id:"foto"},on:{change:t.manageFoto}}),t.foto?e("p",[t._v("Archivo seleccionado: "+t._s(t.foto.name))]):t._e()]),e("button",{staticClass:"btn btn-primary btn-sm m-1",attrs:{type:"button"},on:{click:function(e){return t.crearAutor()}}},[t._v("Crear nuevo autor")]),e("button",{staticClass:"btn btn-warning btn-sm m-1",attrs:{type:"button"},on:{click:function(e){return t.$emit("volver")}}},[t._v("Volver al listado")])])},C=[],A={name:"AutorCreate",data(){return{nombre:"",email:"",foto:null,create_errors:{mail:!1,nombre:!1},response_errors:[]}},methods:{validateEmail(t=null){let e=t||this.email;return String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)},crearAutor(){console.log("a crear autor");let t=0;if(this.validateEmail(this.email)||(this.create_errors.mail=!0,t+=1),this.nombre.length<3&&(this.create_errors.nombre=!0,t+=1),console.log("t errors ",t),t>0)return;let e=new FormData;e.append("nombre",this.nombre),e.append("email",this.email),null!=this.foto&&e.append("foto",this.foto);const o=document.head.querySelector('meta[name="csrf-token"]');let a={"Content-Type":"multipart/form-data",Accept:"application/json"};null!=o&&(a={"Content-Type":"multipart/form-data",Accept:"application/json","X-CSRF-TOKEN":o.content}),this.$axios.post("/autor/crear",e,{headers:a}).then((t=>{this.nombre="",this.email="",this.foto=null,this.create_errors.mail=!1,this.create_errors.nombre=!1,this.response_errors=[],this.$bootbox.confirm({message:t.data.msg,centerVertical:!0,buttons:{confirm:{label:"Volver al listado",className:"btn-success"},cancel:{label:"Crear otro",className:"btn-danger"}},callback:t=>{t&&this.$emit("volver")}})})).catch((t=>{console.error("Error al crear autor:",t),this.$bootbox.alert({message:"Error al intentar crear",size:"small",centerVertical:!0}),this.response_errors=t.response?.data||"Error desconocido"}))},manageFoto(t){const e=t.target.files[0];e?(this.foto=e,console.log(this.foto)):this.foto=null}}},y=A,x=(0,u.A)(y,_,C,!1,null,"3749edcd",null),E=x.exports,P=function(){var t=this,e=t._self._c;return e("form",[e("div",{staticClass:"mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"nombre"}},[t._v("Nombre")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.nombre,expression:"nombre"}],staticClass:"form-control",attrs:{type:"text",id:"nombre","aria-describedby":"name"},domProps:{value:t.nombre},on:{input:function(e){e.target.composing||(t.nombre=e.target.value)}}})]),e("div",{staticClass:"mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"email"}},[t._v("Email ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control",attrs:{type:"email",id:"email","aria-describedby":"email"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}}),1==t.create_errors.mail?e("div",{staticClass:"form-text",attrs:{id:"emailHelp"}},[t._v("We'll never share your email with anyone else.")]):t._e()]),e("div",{staticClass:"mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"foto"}},[t._v("Seleccione nueva foto (opcional)")]),e("input",{staticClass:"form-control",attrs:{type:"file",id:"foto"},on:{change:t.manageFoto}}),t.foto?e("p",[t._v("Archivo seleccionado: "+t._s(t.foto.name))]):t._e()]),null!=t.old_foto?e("div",{staticClass:"card"},[e("div",{staticClass:"card-header"},[t._v(" Foto actual ")]),e("div",{staticClass:"card-body"},[e("img",{attrs:{src:t.$constants.APP_URL+"storage/autores/"+t.old_foto,alt:"foto",width:"120dp",height:"auto"}})])]):t._e(),e("br"),e("button",{staticClass:"btn btn-primary btn-sm m-1",attrs:{type:"button"},on:{click:function(e){return t.actualizarAutor()}}},[t._v("Actualizar autor")]),e("button",{staticClass:"btn btn-warning btn-sm m-1",attrs:{type:"button"},on:{click:function(e){return t.$emit("volver")}}},[t._v("Volver al listado")])])},S=[],$=o(3518),k={name:"AutorEdit",data(){return{id:null,nombre:"",email:"",foto:null,old_foto:null,create_errors:{mail:!1,nombre:!1},response_errors:[]}},methods:{validateEmail(t=null){let e=t||this.email;return String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)},actualizarAutor(){let t=0;if(this.validateEmail(this.email)||(this.create_errors.mail=!0,t+=1),this.nombre.length<3&&(this.create_errors.nombre=!0,t+=1),t>0)return;let e=new FormData;e.append("id",this.id),e.append("nombre",this.nombre),e.append("email",this.email),null!=this.foto&&e.append("foto",this.foto);const o=document.head.querySelector('meta[name="csrf-token"]');let a={"Content-Type":"multipart/form-data",Accept:"application/json"};null!=o&&(a={"Content-Type":"multipart/form-data",Accept:"application/json","X-CSRF-TOKEN":o.content}),this.$axios.post("/autor/actualizar",e,{headers:a}).then((t=>{""!=t.data.data[0]&&(this.old_foto=t.data.data[0]),this.create_errors.mail=!1,this.create_errors.nombre=!1,this.response_errors=[],this.$bootbox.confirm({message:t.data.msg,centerVertical:!0,buttons:{confirm:{label:"Volver al listado",className:"btn-success"},cancel:{label:"Seguir editando",className:"btn-danger"}},callback:t=>{t&&this.$emit("volver")}})})).catch((t=>{console.error("Error al actualizar al autor:"),console.error(t),this.$bootbox.alert({message:"Error al intentar actualizar",size:"small",centerVertical:!0}),this.response_errors=t.response?.data||"Error desconocido"}))},manageFoto(t){const e=t.target.files[0];e?(this.foto=e,console.log(this.foto)):this.foto=null}},computed:{...(0,$.L8)(["getAutorSeleccionado"])},mounted(){console.log("Autor a editar:");const t=this.getAutorSeleccionado;t&&(this.id=t.Id,console.log("en editar, id es ",this.id),this.nombre=t.nombre,this.email=t.email,this.old_foto=t.foto)}},j=k,T=(0,u.A)(j,P,S,!1,null,"637b0b8c",null),w=T.exports,N=function(){var t=this,e=t._self._c;return e("div",[0===t.autores.length?e("p",[t._v("Cargando...")]):t._e(),t.autores.length>0?e("table",{staticClass:"table"},[t._m(0),e("tbody",t._l(t.autores,(function(o){return e("tr",{key:o.Id},[e("td",[e("button",{staticClass:"btn btn-primary btn-sm m-1",attrs:{type:"button"},on:{click:function(e){return t.editar(o.Id)}}},[t._v("Editar")]),e("button",{staticClass:"btn btn-danger btn-sm m-1",attrs:{type:"button"},on:{click:function(e){return t.borrar(o.Id)}}},[t._v("Eliminar")]),e("button",{staticClass:"btn btn-success btn-sm m-1",attrs:{type:"button"},on:{click:function(e){return t.verPosts(o.Id)}}},[t._v("Ver posts")])]),e("td",[t._v(t._s(o.nombre))]),e("td",[t._v(t._s(o.email))]),e("td",[e("img",{attrs:{src:t.$constants.APP_URL+"storage/autores/"+o.foto,alt:"foto",width:"60dp",height:"auto"}})]),e("td",[t._v(t._s(o.created_at))])])})),0)]):t._e()])},L=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("Acciones")]),e("th",{attrs:{scope:"col"}},[t._v("Nombre")]),e("th",{attrs:{scope:"col"}},[t._v("Email")]),e("th",{attrs:{scope:"col"}},[t._v("Foto")]),e("th",{attrs:{scope:"col"}},[t._v("Fecha creación")])])])}],I=(o(8111),o(116),{name:"AutorList",data(){return{autores:[],idAutorSelected:null}},methods:{...(0,$.i0)(["seleccionarAutor"]),loadList(){const t=document.head.querySelector('meta[name="csrf-token"]');let e={"Content-Type":"application/json",Accept:"application/json"};null!=t&&(e={"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":t.content}),this.$axios.get("/autor/list",{headers:e}).then((t=>{this.autores=t.data.data})).catch((t=>{console.error("Error al cargar lista de autores:"),console.log(t)}))},editar(t){let e=this.autores.find((e=>e.Id==t));this.seleccionarAutor(e),this.$emit("cambiar-componente","AutorEdit")},borrarConfirmado(){console.log("a borrar confirmado ",this.idAutorSelected);const t=document.head.querySelector('meta[name="csrf-token"]');let e={"Content-Type":"application/json",Accept:"application/json"};null!=t&&(e={"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":t.content}),this.$axios.post("/autor/borrar",{id:this.idAutorSelected},{headers:e}).then((t=>{this.$bootbox.alert({message:t.data.msg,size:"small",centerVertical:!0,callback:()=>{this.loadList()}})})).catch((t=>{console.error("Error al borrar al autor:"),console.error(t),this.$bootbox.alert({message:t.response.data.msg,size:"small",centerVertical:!0}),this.response_errors=t.response?.data||"Error desconocido"}))},borrar(t){this.idAutorSelected=t,this.$bootbox.confirm({message:"¿Está seguro de que desea borrar este autor?",centerVertical:!0,buttons:{confirm:{label:"Si, borrar",className:"btn-success"},cancel:{label:"No, cancelar",className:"btn-danger"}},callback:t=>{t&&this.borrarConfirmado()}})},verPosts(t){console.log("a ver los posts de este autor",t)}},mounted(){setTimeout((()=>{this.loadList()}),200)}}),O=I,z=(0,u.A)(O,N,L,!1,null,"a9572c12",null),V=z.exports,F=(o(1701),function(){var t=this,e=t._self._c;return e("form",[e("div",{staticClass:"mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"autor"}},[t._v("Seleccione un autor")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.autorElegido,expression:"autorElegido"}],staticClass:"form-select",attrs:{id:"autor",placeholder:"Seleccione un autor"},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.autorElegido=e.target.multiple?o:o[0]}}},[0===t.autores.length?e("option",{attrs:{selected:""}},[t._v("Cargando...")]):t._e(),t._l(t.autores,(function(o){return e("option",{key:o.Id,domProps:{value:o.Id}},[t._v(t._s(o.Nombre))])}))],2),1==t.create_errors.autor?e("span",{staticClass:"text-danger"},[t._v("El autor es obligatorio")]):t._e()]),e("div",{staticClass:"mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"titulo"}},[t._v("Titulo")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.titulo,expression:"titulo"}],staticClass:"form-control",attrs:{type:"text",id:"titulo","aria-describedby":"titulo"},domProps:{value:t.titulo},on:{input:function(e){e.target.composing||(t.titulo=e.target.value)}}}),1==t.create_errors.titulo?e("span",{staticClass:"text-danger"},[t._v("El titulo es obligatorio")]):t._e()]),e("div",{staticClass:"mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"contenido"}},[t._v("Contenido del post")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.contenido,expression:"contenido"}],staticClass:"form-control",attrs:{id:"contenido",rows:"5",maxlength:t.maxChars},domProps:{value:t.contenido},on:{input:function(e){e.target.composing||(t.contenido=e.target.value)}}}),e("p",{staticClass:"text-danger text-sm"},[e("i",[t._v("Caracteres restantes: "+t._s(t.charsLeft))])]),1==t.create_errors.contenido?e("span",{staticClass:"text-danger"},[t._v("El contenido es obligatorio")]):t._e()]),e("div",{staticClass:"mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"imagen"}},[t._v("Seleccione una imagen")]),e("input",{staticClass:"form-control",attrs:{type:"file",id:"imagen"},on:{change:t.manageImg}}),t.imagen?e("p",[t._v("Archivo seleccionado: "+t._s(t.imagen.name))]):t._e(),1==t.create_errors.imagen?e("span",{staticClass:"text-danger"},[t._v("La imagen es obligatoria")]):t._e()]),e("button",{staticClass:"btn btn-primary btn-sm m-1",attrs:{type:"button"},on:{click:function(e){return t.crearPost()}}},[t._v("Crear nuevo post")]),e("button",{staticClass:"btn btn-warning btn-sm m-1",attrs:{type:"button"},on:{click:function(e){return t.$emit("listPosts")}}},[t._v("Volver al listado de posts")])])}),R=[],q=(o(7588),{name:"AutorCreate",data(){return{titulo:"",contenido:"",imagen:null,autores:[],autorElegido:null,create_errors:{titulo:!1,contenido:!1,imagen:!1,autor:!1},response_errors:[],maxChars:512}},methods:{crearPost(){console.log("a crear post");let t=0;if(this.$set(this.create_errors,"titulo",!1),this.$set(this.create_errors,"contenido",!1),this.$set(this.create_errors,"imagen",!1),this.$set(this.create_errors,"autor",!1),this.titulo.length<3&&(this.create_errors.titulo=!0,t+=1),this.contenido.length<3&&(this.create_errors.contenido=!0,t+=1),null==this.autorElegido&&(this.create_errors.autor=!0,t+=1),null==this.imagen&&(this.create_errors.imagen=!0,t+=1),console.log(this.create_errors),t>0)return;if(this.contenido.length>this.maxChars)return void this.$bootbox.alert({message:"El contenido es muy largo",size:"small",centerVertical:!0});let e=new FormData;e.append("titulo",this.titulo),e.append("content",this.contenido),e.append("autor",this.autorElegido),null!=this.imagen&&e.append("imagen",this.imagen);const o=document.head.querySelector('meta[name="csrf-token"]');let a={"Content-Type":"multipart/form-data",Accept:"application/json"};null!=o&&(a={"Content-Type":"multipart/form-data",Accept:"application/json","X-CSRF-TOKEN":o.content});for(let s of e.entries())console.log(s[0]+", "+s[1]);this.$axios.post("/post/crear",e,{headers:a}).then((t=>{this.titulo="",this.contenido="",this.imagen=null,this.autorElegido=null;let e=t.data.msg;t.data.data>0&&t.data.data.forEach((t=>{e+=t+"\n"})),this.$bootbox.confirm({message:e,centerVertical:!0,buttons:{confirm:{label:"Volver al listado",className:"btn-success"},cancel:{label:"Crear otro",className:"btn-danger"}},callback:t=>{t&&this.$emit("listPosts")}})})).catch((t=>{console.error("Error al crear autor:",t),this.$bootbox.alert({message:t.message,size:"small",centerVertical:!0}),this.response_errors=t.response?.data||"Error desconocido"}))},manageImg(t){const e=t.target.files[0];e?(this.imagen=e,console.log(this.imagen)):this.foto=null},loadAutors(){const t=document.head.querySelector('meta[name="csrf-token"]');let e={"Content-Type":"application/json",Accept:"application/json"};null!=t&&(e={"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":t.content}),this.$axios.get("/autor/for_select",{headers:e}).then((t=>{this.autores=t.data.data})).catch((t=>{console.error("Error al cargar lista de autores:"),console.log(t)}))}},mounted(){console.log("POst a crear:"),setTimeout((()=>{this.loadAutors()}),2e3)},computed:{charsLeft(){return this.maxChars-this.contenido.length}}}),K=q,X=(0,u.A)(K,F,R,!1,null,"62ca2453",null),U=X.exports,M=function(){var t=this,e=t._self._c;return e("div",[0===t.autores.length?e("p",[t._v("Cargando...")]):t._e(),e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-6"},[e("div",{staticClass:"mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"autor"}},[t._v("Filtrar por autor")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.autorElegido,expression:"autorElegido"}],staticClass:"form-select",attrs:{id:"autor",placeholder:"Seleccione un autor"},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.autorElegido=e.target.multiple?o:o[0]}}},[0===t.autores.length?e("option",{attrs:{selected:""}},[t._v("Cargando...")]):e("option",{attrs:{value:"todos",selected:""}},[t._v("Cargar todos")]),t._l(t.autores,(function(o){return e("option",{key:o.Id,domProps:{value:o.Id}},[t._v(" "+t._s(o.Nombre)+" ")])}))],2)])]),e("div",{staticClass:"col-sm-6"},[e("label",{staticClass:"form-label",attrs:{for:"bCarga"}},[t._v(".")]),e("button",{staticClass:"btn btn-primary form-select",attrs:{type:"button",id:"bCarga"},on:{click:function(e){return t.loadPosts()}}},[t._v("Cargar posts")])])]),0==t.posts.length?e("span",{staticClass:"text-danger text-sm"},[t._v("Seleccione un criterio y haga click en el boton "),e("i",[t._v("Cargar posts")])]):t._e(),t.posts.length>0?e("table",{staticClass:"table"},[t._m(0),e("tbody",t._l(t.posts,(function(o){return e("tr",{key:o.Id},[e("td",[e("button",{staticClass:"btn btn-primary btn-sm m-1",attrs:{type:"button"},on:{click:function(e){return t.editar(o.Id)}}},[t._v("Editar")]),e("button",{staticClass:"btn btn-danger btn-sm m-1",attrs:{type:"button"},on:{click:function(e){return t.borrar(o.Id)}}},[t._v("Eliminar")]),e("button",{staticClass:"btn btn-success btn-sm m-1",attrs:{type:"button"},on:{click:function(e){return t.editar(o.Id)}}},[t._v("Ver")])]),e("td",[t._v(t._s(o.titulo))]),e("td",[e("img",{attrs:{src:t.$constants.APP_URL+"storage/posts/"+o.imagen,alt:"foto",width:"60dp",height:"auto"}})]),e("td",[t._v(t._s(o.autor))]),e("td",[t._v(t._s(o.created_at))])])})),0)]):t._e()])},D=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("Acciones")]),e("th",{attrs:{scope:"col"}},[t._v("Titulo")]),e("th",{attrs:{scope:"col"}},[t._v("Imagen")]),e("th",{attrs:{scope:"col"}},[t._v("Autor")]),e("th",{attrs:{scope:"col"}},[t._v("Fecha creación")])])])}],Z={name:"PostList",data(){return{posts:[],idAutorSelected:null,autores:[],IdPostElegido:null,autorElegido:"todos",post:null}},methods:{...(0,$.i0)(["seleccionarAutor","seleccionarPost"]),loadAutors(){const t=document.head.querySelector('meta[name="csrf-token"]');let e={"Content-Type":"application/json",Accept:"application/json"};null!=t&&(e={"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":t.content}),this.$axios.get("/autor/for_select",{headers:e}).then((t=>{this.autores=t.data.data})).catch((t=>{console.error("Error al cargar lista de posts:"),console.log(t)}))},loadPosts(){console.log("a cargar posts"),console.log("a borrar confirmado ",this.autorElegido);const t=document.head.querySelector('meta[name="csrf-token"]');let e={"Content-Type":"application/json",Accept:"application/json"};null!=t&&(e={"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":t.content}),this.$axios.post("/post/list",{autor:this.autorElegido},{headers:e}).then((t=>{console.log("responsee"),console.log(t.data),t.data.done?(this.posts=t.data.data,console.log("posts"),console.log(this.posts)):(this.posts=[],this.$bootbox.alert({message:t.data.msg,size:"small",centerVertical:!0}))})).catch((t=>{console.error("Error al cargar posts :"),console.error(t),this.$bootbox.alert({message:"Error al intentar cargar",size:"small",centerVertical:!0}),this.response_errors=t.response?.data||"Error desconocido"}))},editar(t){let e=this.posts.find((e=>e.Id==t));this.seleccionarPost(e),this.$emit("cambiar-componente","PostEdit")},borrarConfirmado(){console.log("a borrar confirmado ",this.IdPostElegido);const t=document.head.querySelector('meta[name="csrf-token"]');let e={"Content-Type":"application/json",Accept:"application/json"};null!=t&&(e={"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":t.content}),this.$axios.post("/post/borrar",{id:this.IdPostElegido},{headers:e}).then((t=>{this.$bootbox.alert({message:t.data.msg,size:"small",centerVertical:!0,callback:()=>{this.loadPosts()}})})).catch((t=>{console.error("Error al borrar al autor:"),console.error(t),this.$bootbox.alert({message:"Error al intentar borrar",size:"small",centerVertical:!0}),this.response_errors=t.response?.data||"Error desconocido"}))},borrar(t){console.log("a borrar el post con id ",t),this.IdPostElegido=t,this.$bootbox.confirm({message:"¿Está seguro de que desea borrar este post?",centerVertical:!0,buttons:{confirm:{label:"Si, borrar",className:"btn-success"},cancel:{label:"No, cancelar",className:"btn-danger"}},callback:t=>{t&&this.borrarConfirmado()}})}},mounted(){setTimeout((()=>{this.loadAutors()}),200)}},H=Z,W=(0,u.A)(H,M,D,!1,null,"2a3a240e",null),B=W.exports,G=function(){var t=this,e=t._self._c;return e("form",[e("div",{staticClass:"mb-3"},[e("label",{staticClass:"form-label text-danger",attrs:{for:"autor"}},[t._v("Autor : "),e("b",[t._v(t._s(t.autor))])])]),e("div",{staticClass:"mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"titulo"}},[t._v("Titulo")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.titulo,expression:"titulo"}],staticClass:"form-control",attrs:{type:"text",id:"titulo","aria-describedby":"titulo"},domProps:{value:t.titulo},on:{input:function(e){e.target.composing||(t.titulo=e.target.value)}}}),1==t.create_errors.titulo?e("span",{staticClass:"text-danger"},[t._v("El titulo es obligatorio")]):t._e()]),e("div",{staticClass:"mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"contenido"}},[t._v("Contenido del post")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.contenido,expression:"contenido"}],staticClass:"form-control",attrs:{id:"contenido",rows:"4",maxlength:t.maxChars},domProps:{value:t.contenido},on:{input:function(e){e.target.composing||(t.contenido=e.target.value)}}}),e("p",{staticClass:"text-danger text-sm"},[e("i",[t._v("Caracteres restantes: "+t._s(t.charsLeft))])]),1==t.create_errors.contenido?e("span",{staticClass:"text-danger"},[t._v("El contenido es obligatorio")]):t._e()]),e("div",{staticClass:"mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"imagen"}},[t._v("Seleccione una imagen")]),e("input",{staticClass:"form-control",attrs:{type:"file",id:"imagen"},on:{change:t.manageImg}}),t.imagen?e("p",[t._v("Archivo seleccionado: "+t._s(t.imagen.name))]):t._e(),1==t.create_errors.imagen?e("span",{staticClass:"text-danger"},[t._v("La imagen es obligatoria")]):t._e()]),null!=t.old_image?e("div",{staticClass:"card"},[e("div",{staticClass:"card-header"},[t._v(" Foto actual ")]),e("div",{staticClass:"card-body"},[e("img",{attrs:{src:t.$constants.APP_URL+"storage/posts/"+t.old_image,alt:"foto",width:"420dp",height:"auto"}})])]):t._e(),e("br"),e("button",{staticClass:"btn btn-primary btn-sm m-1",attrs:{type:"button"},on:{click:function(e){return t.actualizarPost()}}},[t._v("Actualizar el post")]),e("button",{staticClass:"btn btn-warning btn-sm m-1",attrs:{type:"button"},on:{click:function(e){return t.$emit("listPosts")}}},[t._v("Volver al listado de posts")])])},J=[],Q={name:"PostEdit",data(){return{id:null,titulo:"Un nuevo post",contenido:"Juega este gran juego que me gusta",imagen:null,autores:[],autorElegido:null,create_errors:{titulo:!1,contenido:!1,imagen:!1},response_errors:[],maxChars:512,old_image:null,autor:null}},methods:{actualizarPost(){console.log("a crear post");let t=0;if(this.$set(this.create_errors,"titulo",!1),this.$set(this.create_errors,"contenido",!1),this.$set(this.create_errors,"imagen",!1),this.titulo.length<3&&(this.create_errors.titulo=!0,t+=1),this.contenido.length<3&&(this.create_errors.contenido=!0,t+=1),console.log(this.create_errors),t>0)return;if(this.contenido.length>this.maxChars)return void this.$bootbox.alert({message:"El contenido es muy largo",size:"small",centerVertical:!0});let e=new FormData;e.append("titulo",this.titulo),e.append("content",this.contenido),e.append("IdPost",this.id),null!=this.imagen&&e.append("imagen",this.imagen);const o=document.head.querySelector('meta[name="csrf-token"]');let a={"Content-Type":"multipart/form-data",Accept:"application/json"};null!=o&&(a={"Content-Type":"multipart/form-data",Accept:"application/json","X-CSRF-TOKEN":o.content});for(let s of e.entries())console.log(s[0]+", "+s[1]);this.$axios.post("/post/actualizar",e,{headers:a}).then((t=>{this.imagen=null,""!=t.data.data[0]&&(this.old_image=t.data.data[0]);let e=t.data.msg;t.data.data>0&&t.data.data.forEach((t=>{e+=t+"\n"})),this.$bootbox.confirm({message:e,centerVertical:!0,buttons:{confirm:{label:"Volver al listado",className:"btn-success"},cancel:{label:"Seguir actualizando",className:"btn-danger"}},callback:t=>{t&&this.$emit("listPosts")}})})).catch((t=>{console.error("Error al crear autor:",t),this.$bootbox.alert({message:t.message,size:"small",centerVertical:!0}),this.response_errors=t.response?.data||"Error desconocido"}))},manageImg(t){const e=t.target.files[0];e?(this.imagen=e,console.log(this.imagen)):this.foto=null},loadAutors(){const t=document.head.querySelector('meta[name="csrf-token"]');let e={"Content-Type":"application/json",Accept:"application/json"};null!=t&&(e={"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":t.content}),this.$axios.get("/autor/for_select",{headers:e}).then((t=>{this.autores=t.data.data})).catch((t=>{console.error("Error al cargar lista de autores:"),console.log(t)}))}},computed:{...(0,$.L8)(["getPostSeleccionado"]),charsLeft(){return this.maxChars-this.contenido.length}},mounted(){console.log("Post a editar:");const t=this.getPostSeleccionado;t&&(this.id=t.Id,console.log("en editar, id es ",this.id),this.titulo=t.titulo,this.contenido=t.contenido,this.old_image=t.imagen,this.autor=t.autor),setTimeout((()=>{this.loadAutors()}),500)}},Y=Q,tt=(0,u.A)(Y,G,J,!1,null,"01bf06a8",null),et=tt.exports,ot={name:"App",components:{LeftMenu:m,Footer:v,AutorCreate:E,AutorEdit:w,AutorList:V,PostCreate:U,PostList:B,PostEdit:et},data(){return{titulo:"Seleccione una opción en el menú de la izquierda",accion:null,componenteActual:null,autorActual:null,postActual:null,acciones:["AutorCreate","AutorList","PostCreate","PostList","AutorEdit","PostEdit"],accionesTitulos:["Crear un nuevo autor","Listar todos los autores","Crear un nuevo post","Listar los posts","Editar un autor","Editar un post"]}},methods:{setAccion(t,e=null){console.log("compo setAccion ",t),this.accion=t,this.titulo=this.accionesTitulos[this.acciones.indexOf(this.accion)],"AutorEdit"===t&&(this.autorActual=e),"PostEdit"===t&&(this.postActual=e)}}},at=ot,st=(0,u.A)(at,s,r,!1,null,null,null),rt=st.exports,nt=o(5168),it=(o(9313),o(323),o(4373)),lt=o(954),ct=o.n(lt);a["default"].use($.Ay);var ut=new $.Ay.Store({state:{autorSeleccionado:null,postSeleccionado:null},mutations:{setAutor(t,e){t.autorSeleccionado=e},setPost(t,e){t.postSeleccionado=e}},actions:{seleccionarAutor({commit:t},e){t("setAutor",e)},seleccionarPost({commit:t},e){t("setPost",e)}},getters:{getAutorSeleccionado:t=>t.autorSeleccionado,getPostSeleccionado:t=>t.postSeleccionado}});a["default"].use(nt.Ay$),a["default"].config.productionTip=!1,a["default"].prototype.$constants=Object.freeze({APP_URL:"https://test-blog.bitmo.co/",API_URL:"https://test-blog.bitmo.co/api/",APP_NAME:"Blog Manager",VERSION:"0.0.1"}),a["default"].prototype.$axios=it.A.create({baseURL:a["default"].prototype.$constants.API_URL,timeout:1e4,headers:{"Content-Type":"application/json"}}),a["default"].prototype.$bootbox=ct(),new a["default"]({store:ut,render:t=>t(rt)}).$mount("#app")}},e={};function o(a){var s=e[a];if(void 0!==s)return s.exports;var r=e[a]={exports:{}};return t[a].call(r.exports,r,r.exports,o),r.exports}o.m=t,function(){var t=[];o.O=function(e,a,s,r){if(!a){var n=1/0;for(u=0;u<t.length;u++){a=t[u][0],s=t[u][1],r=t[u][2];for(var i=!0,l=0;l<a.length;l++)(!1&r||n>=r)&&Object.keys(o.O).every((function(t){return o.O[t](a[l])}))?a.splice(l--,1):(i=!1,r<n&&(n=r));if(i){t.splice(u--,1);var c=s();void 0!==c&&(e=c)}}return e}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[a,s,r]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var a in e)o.o(e,a)&&!o.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={524:0};o.O.j=function(e){return 0===t[e]};var e=function(e,a){var s,r,n=a[0],i=a[1],l=a[2],c=0;if(n.some((function(e){return 0!==t[e]}))){for(s in i)o.o(i,s)&&(o.m[s]=i[s]);if(l)var u=l(o)}for(e&&e(a);c<n.length;c++)r=n[c],o.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return o.O(u)},a=self["webpackChunktest_blog"]=self["webpackChunktest_blog"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=o.O(void 0,[504],(function(){return o(1486)}));a=o.O(a)})();
//# sourceMappingURL=app.1e54cbeb.js.map